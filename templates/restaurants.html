{% extends "_base.html" %}
{% from "_macros.html" import nav_bar, header, search_form, message_flashing, show_tags %}
{% from "_macros_js.html" import google_maps_script %}

<!-- HEAD -->
{% block title %}
  <title>Restaurants</title>
{% endblock %}

{% block description %}
    <meta description="still i'll have to fill this up">
{% endblock%}


<!-- BODY -->
{% block content %}

  {{ nav_bar({"Search":"#search", "Tags":"#tags", "Locations":"#locations"}) }}

  {{ header(main_page=False, prompt_cities=prompt_cities) }}

  {{ message_flashing() }}

    <!-- Restaurant info section -->
    <section class="bg-white" id="search">
      <div class="container item">
        <div class="row">
          <div class="col-lg-12 text-left">

            <h1 class="section-heading">Find a place for you in... {{ location }}</h1>
            <br>

              {{ search_form(location, user_input, prompt_cities) }}

          </div>
        </div>

      </div>
    </section>





    <!-- Menu Items section -->
    <section class="bg-light" id="restaurants">
      <div class="container">
        <div class="row" id="restaurant-results">
          
          <!-- RESULTS RECEIVED BY AJAX -->

        </div>
      </div>

    </section>





    <!-- Comments section -->
    <section class="bg-white" id="tags">

      <div class="container item">
        <div class="row">
          <div class="col-lg-12 text-left">
            <h5 class="section-heading">Tags:</h5>
            {{ show_tags(tags) }}
          </div>
        </div>
      </div>

      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            <hr>
          </div>
        </div>
      </div>

      <div class="container item" id="locations">
        <div class="row">
          <div class="col-lg-12 text-left">
            <h5 class="section-heading">Most popular locations:</h5>
          </div>

            {% for place in places %}
              <div class="col-lg-4 col-md-6">
                <a class="text-muted" href="#" style="display: block;">{{ place }}</a>
              </div>
            {% endfor %}

        </div>
      </div>

    </section>

{% endblock %}

{% block scripts %}

<script type="text/javascript">

  $(document).ready(function() {
    $('#drop-name').on('click', function() {
      $('#user-column').val('Name');
    });
    $('#drop-lat-name').on('click', function() {
      $('#user-column').val('Latin Name');
    });
  });



  $(document).ready(function() {
    search_restaurants();
  });



  $(document).ready(function() {

    $(document).on('click', '#search-btn', function(event) {

      search_restaurants();

      event.preventDefault();

  });
});


  var search_restaurants = function() {
      req=$.ajax({
        data : {
          location: $('input[name="location"]').val(),
          input: $('input[name="input"]').val()
        },
        type: 'POST',
        url: '/_search_results'

      });
      req.done(function(data) {
        $('#restaurant-results').html(data);
      })
  }


</script>


{% endblock%}